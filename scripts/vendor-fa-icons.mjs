import fs from "node:fs";
import path from "node:path";

import { faJava, faJs, faGolang } from "@fortawesome/free-brands-svg-icons";

const OUT_FILE = process.env.OUT_FILE || "scripts/icons.fa.vendored.js";

/**
 * Font Awesome icon definition:
 * { prefix, iconName, icon: [width, height, ligatures, unicode, svgPathData] }
 */
function pickFA(def) {
  const [width, height, , , d] = def.icon;
  const paths = Array.isArray(d) ? d : [d];
  return { width, height, paths };
}

function toModule(obj) {
  return `// AUTO-GENERATED by scripts/vendor-fa-icons.mjs
// Source: Font Awesome Free (icons under CC BY 4.0). Keep attribution.
// See license: https://fontawesome.com/license/free
export const ICONS = ${JSON.stringify(obj, null, 2)};
`;
}

function main() {
  // ВАЖНО: TypeScript бренд-иконки в FA Free нет → используем монограмму в генераторе.
  const icons = {
    JavaScript: { ...pickFA(faJs), color: "#F7DF1E" },
    Java: { ...pickFA(faJava), color: "#ED8B00" },
    Go: { ...pickFA(faGolang), color: "#00ADD8" },
  };

  fs.mkdirSync(path.dirname(OUT_FILE), { recursive: true });
  fs.writeFileSync(OUT_FILE, toModule(icons), "utf8");
  console.log(`Vendored ${Object.keys(icons).length} icons -> ${OUT_FILE}`);
}

main();
